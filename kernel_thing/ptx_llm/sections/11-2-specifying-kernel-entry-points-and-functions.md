## 11.2. Specifying Kernel Entry Points and Functions 

The following directives specify kernel entry points and functions.

* `.entry`
* `.func`

### 11.2.1. [Kernel and Function Directives: `.entry`](#kernel-and-function-directives-entry)[](#kernel-and-function-directives-entry "Permalink to this headline")

`.entry`

Kernel entry point and body, with optional parameters.

Syntax

```
.entry kernel-name ( param-list )  kernel-body

.entry kernel-name  kernel-body
```

Description

Defines a kernel entry point name, parameters, and body for the kernel function.

Parameters are passed via `.param` space memory and are listed within an optional parenthesized
parameter list. Parameters may be referenced by name within the kernel body and loaded into
registers using `ld.param{::entry}` instructions.

In addition to normal parameters, opaque `.texref`, `.samplerref`, and `.surfref` variables
may be passed as parameters. These parameters can only be referenced by name within texture and
surface load, store, and query instructions and cannot be accessed via `ld.param` instructions.

The shape and size of the CTA executing the kernel are available in special registers.

Semantics

Specify the entry point for a kernel program.

At kernel launch, the kernel dimensions and properties are established and made available via
special registers, e.g., `%ntid`, `%nctaid`, etc.

PTX ISA Notes

For PTX ISA version 1.4 and later, parameter variables are declared in the kernel parameter
list. For PTX ISA versions 1.0 through 1.3, parameter variables are declared in the kernel body.

The maximum memory size supported by PTX for normal (non-opaque type) parameters is 32764
bytes. Depending upon the PTX ISA version, the parameter size limit varies. The following table
shows the allowed parameter size for a PTX ISA version:

| PTX ISA Version | Maximum parameter size (In bytes) |
| --- | --- |
| PTX ISA version 8.1 and above | 32764 |
| PTX ISA version 1.5 and above | 4352 |
| PTX ISA version 1.4 and above | 256 |

The CUDA and OpenCL drivers support the following limits for parameter memory:

| Driver | Parameter memory size |
| --- | --- |
| CUDA | 256 bytes for `sm_1x`, 4096 bytes for `sm_2x and higher`, 32764 bytes fo `sm_70` and higher |
| OpenCL | 32764 bytes for `sm_70` and higher, 4352 bytes on `sm_6x` and lower |

Target ISA Notes

Supported on all target architectures.

Examples

```
.entry cta_fft

.entry filter ( .param .b32 x, .param .b32 y, .param .b32 z )

{

    .reg .b32 %r<99>;

    ld.param.b32  %r1, [x];

    ld.param.b32  %r2, [y];

    ld.param.b32  %r3, [z];

    ...

}



.entry prefix_sum ( .param .align 4 .s32 pitch[8000] )

{

    .reg .s32 %t;

    ld.param::entry.s32  %t, [pitch];

    ...

}
```

### 11.2.2. [Kernel and Function Directives: `.func`](#kernel-and-function-directives-func)[](#kernel-and-function-directives-func "Permalink to this headline")

`.func`

Function definition.

Syntax

```
.func {.attribute(attr-list)} fname {.noreturn} {.abi_preserve N} {.abi_preserve_control N} function-body

.func {.attribute(attr-list)} fname (param-list) {.noreturn} {.abi_preserve N} {.abi_preserve_control N} function-body

.func {.attribute(attr-list)} (ret-param) fname (param-list) {.abi_preserve N} {.abi_preserve_control N} function-body
```

Description

Defines a function, including input and return parameters and optional function body.

An optional `.noreturn` directive indicates that the function does not return to the caller
function. `.noreturn` directive cannot be specified on functions which have return parameters. See
the description of `.noreturn` directive in [Performance-Tuning Directives: .noreturn](#performance-tuning-directives-noreturn).

An optional `.attribute` directive specifies additional information associated with the
function. See the description of [Variable and Function Attribute Directive: .attribute](#variable-and-function-attribute-directive-attribute)
for allowed attributes.

Optional `.abi_preserve` and `.abi_preserve_control` directives are used to specify the number
of general purpose registers and control registers. See description of [Performance-Tuning Directives: .abi\_preserve](#performance-tuning-directives-abi-preserve)
and [Performance-Tuning Directives: .abi\_preserve\_control](#performance-tuning-directives-abi-preserve-control) for more details.

A `.func` definition with no body provides a function prototype.

The parameter lists define locally-scoped variables in the function body. Parameters must be base
types in either the register or parameter state space. Parameters in register state space may be
referenced directly within instructions in the function body. Parameters in `.param` space are
accessed using `ld.param{::func}` and `st.param{::func}` instructions in the body. Parameter
passing is call-by-value.

The last parameter in the parameter list may be a `.param` array of type `.b8` with no size
specified. It is used to pass an arbitrary number of parameters to the function packed into a single
array object.

When calling a function with such an unsized last argument, the last argument may be omitted from
the `call` instruction if no parameter is passed through it. Accesses to this array parameter must
be within the bounds of the array. The result of an access is undefined if no array was passed, or
if the access was outside the bounds of the actual array being passed.

Semantics

The PTX syntax hides all details of the underlying calling convention and ABI.

The implementation of parameter passing is left to the optimizing translator, which may use a
combination of registers and stack locations to pass parameters.

Release Notes

For PTX ISA version 1.x code, parameters must be in the register state space, there is no stack, and
recursion is illegal.

PTX ISA versions 2.0 and later with target `sm_20` or higher allow parameters in the `.param`
state space, implements an ABI with stack, and supports recursion.

PTX ISA versions 2.0 and later with target `sm_20` or higher support at most one return value.

PTX ISA Notes

Introduced in PTX ISA version 1.0.

Support for unsized array parameter introduced in PTX ISA version 6.0.

Support for `.noreturn` directive introduced in PTX ISA version 6.4.

Support for `.attribute` directive introduced in PTX ISA version 8.0.

Support for `.abi_preserve` and `.abi_preserve_control` directives introduced in PTX ISA version 9.0.

Target ISA Notes

Functions without unsized array parameter supported on all target architectures.

Unsized array parameter requires `sm_30` or higher.

`.noreturn` directive requires `sm_30` or higher.

`.attribute` directive requires `sm_90` or higher.

`.abi_preserve` and `.abi_preserve_control` directives require `sm_80` or higher.

Examples

```
.func (.reg .b32 rval) foo (.reg .b32 N, .reg .f64 dbl)

{

.reg .b32 localVar;



... use N, dbl;

other code;



mov.b32 rval,result;

ret;

}



...

call (fooval), foo, (val0, val1);  // return value in fooval

...



.func foo (.reg .b32 N, .reg .f64 dbl) .noreturn

{

.reg .b32 localVar;

... use N, dbl;

other code;

mov.b32 rval, result;

ret;

}

...

call foo, (val0, val1);

...



.func (.param .u32 rval) bar(.param .u32 N, .param .align 4 .b8 numbers[])

{

    .reg .b32 input0, input1;

    ld.param.b32   input0, [numbers + 0];

    ld.param.b32   input1, [numbers + 4];

    ...

    other code;

    ret;

}

...



.param .u32 N;

.param .align 4 .b8 numbers[8];

st.param.u32    [N], 2;

st.param.b32    [numbers + 0], 5;

st.param.b32    [numbers + 4], 10;

call (rval), bar, (N, numbers);

...
```

### 11.2.3. [Kernel and Function Directives: `.alias`](#kernel-and-function-directives-alias)[](#kernel-and-function-directives-alias "Permalink to this headline")

`.alias`

Define an alias to existing function symbol.

Syntax

```
.alias fAlias, fAliasee;
```

Description

`.alias` is a module scope directive that defines identifier `fAlias` to be an alias to function
specified by `fAliasee`.

Both `fAlias` and `fAliasee` are non-entry function symbols.

Identifier `fAlias` is a function declaration without body.

Identifier `fAliasee` is a function symbol which must be defined in the same module as `.alias`
declaration. Function `fAliasee` cannot have `.weak` linkage.

Prototype of `fAlias` and `fAliasee` must match.

Program can use either `fAlias` or `fAlisee` identifiers to reference function defined with
`fAliasee`.

PTX ISA Notes

`.alias` directive introduced in PTX ISA 6.3.

Target ISA Notes

`.alias` directive requires `sm_30` or higher.

Examples

```
.visible .func foo(.param .u32 p) {

   ...

}

.visible .func bar(.param .u32 p);

.alias bar, foo;

.entry test()

{

      .param .u32 p;

      ...

      call foo, (p);       // call foo directly

       ...

       .param .u32 p;

       call bar, (p);        // call foo through alias

}

.entry filter ( .param .b32 x, .param .b32 y, .param .b32 z )

{

    .reg .b32 %r1, %r2, %r3;

    ld.param.b32  %r1, [x];

    ld.param.b32  %r2, [y];

    ld.param.b32  %r3, [z];

    ...

}
```