## 11.5. Debugging Directives 

DWARF-format debug information is passed through PTX modules using the following directives:

* `@@DWARF`
* `.section`
* `.file`
* `.loc`

The `.section` directive was introduced in PTX ISA version 2.0 and replaces the `@@DWARF`
syntax. The `@@DWARF` syntax was deprecated in PTX ISA version 2.0 but is supported for legacy PTX
ISA version 1.x code.

Beginning with PTX ISA version 3.0, PTX files containing DWARF debug information should include the
`.target debug` platform option. This forward declaration directs PTX compilation to retain
mappings for source-level debugging.

### 11.5.1. [Debugging Directives: `@@dwarf`](#debugging-directives-atatdwarf)[](#debugging-directives-atatdwarf "Permalink to this headline")

`@@dwarf`

DWARF-format information.

Syntax

```
@@DWARF dwarf-string



dwarf-string may have one of the

.byte   byte-list   // comma-separated hexadecimal byte values

.4byte  int32-list  // comma-separated hexadecimal integers in range [0..2^32-1]

.quad   int64-list  // comma-separated hexadecimal integers in range [0..2^64-1]

.4byte  label

.quad   label
```

PTX ISA Notes

Introduced in PTX ISA version 1.2. Deprecated as of PTX ISA version 2.0, replaced by `.section`
directive.

Target ISA Notes

Supported on all target architectures.

Examples

```
@@DWARF .section .debug_pubnames, "", @progbits

@@DWARF .byte   0x2b, 0x00, 0x00, 0x00, 0x02, 0x00

@@DWARF .4byte  .debug_info

@@DWARF .4byte  0x000006b5, 0x00000364, 0x61395a5f, 0x5f736f63

@@DWARF .4byte  0x6e69616d, 0x63613031, 0x6150736f, 0x736d6172

@@DWARF .byte   0x00, 0x00, 0x00, 0x00, 0x00
```

### 11.5.2. [Debugging Directives: `.section`](#debugging-directives-section)[](#debugging-directives-section "Permalink to this headline")

`.section`

PTX section definition.

Syntax

```
.section section_name { dwarf-lines }



dwarf-lines have the following formats:

  .b8    byte-list       // comma-separated list of integers

                         // in range [-128..255]

  .b16   int16-list      // comma-separated list of integers

                         // in range [-2^15..2^16-1]

  .b32   int32-list      // comma-separated list of integers

                         // in range [-2^31..2^32-1]

  label:                 // Define label inside the debug section

  .b64   int64-list      // comma-separated list of integers

                         // in range [-2^63..2^64-1]

  .b32   label

  .b64   label

  .b32   label+imm       // a sum of label address plus a constant integer byte

                         // offset(signed, 32bit)

  .b64   label+imm       // a sum of label address plus a constant integer byte

                         // offset(signed, 64bit)

  .b32   label1-label2   // a difference in label addresses between labels in

                         // the same dwarf section (32bit)

  .b64   label3-label4   // a difference in label addresses between labels in

                         // the same dwarf section (64bit)
```

PTX ISA Notes

Introduced in PTX ISA version 2.0, replaces `@@DWARF` syntax.

label+imm expression introduced in PTX ISA version 3.2.

Support for `.b16` integers in dwarf-lines introduced in PTX ISA version 6.0.

Support for defining `label` inside the DWARF section is introduced in PTX ISA version 7.2.

`label1-label2` expression introduced in PTX ISA version 7.5.

Negative numbers in dwarf lines introduced in PTX ISA version 7.5.

Target ISA Notes

Supported on all target architectures.

Examples

```
.section .debug_pubnames

{

    .b32    LpubNames_end0-LpubNames_begin0

  LpubNames_begin0:

    .b8     0x2b, 0x00, 0x00, 0x00, 0x02, 0x00

    .b32    .debug_info

  info_label1:

    .b32    0x000006b5, 0x00000364, 0x61395a5f, 0x5f736f63

    .b32    0x6e69616d, 0x63613031, 0x6150736f, 0x736d6172

    .b8     0x00, 0x00, 0x00, 0x00, 0x00

  LpubNames_end0:

}



.section .debug_info

{

    .b32 11430

    .b8 2, 0

    .b32 .debug_abbrev

    .b8 8, 1, 108, 103, 101, 110, 102, 101, 58, 32, 69, 68, 71, 32, 52, 46, 49

    .b8 0

    .b32 3, 37, 176, -99

    .b32 info_label1

    .b32 .debug_loc+0x4

    .b8 -11, 11, 112, 97

    .b32 info_label1+12

    .b64 -1

    .b16 -5, -65535

}
```

### 11.5.3. [Debugging Directives: `.file`](#debugging-directives-file)[](#debugging-directives-file "Permalink to this headline")

`.file`

Source file name.

Syntax

```
.file file_index "filename" {, timestamp, file_size}
```

Description

Associates a source filename with an integer index. `.loc` directives reference source files by
index.

`.file` directive allows optionally specifying an unsigned number representing time of last
modification and an unsigned integer representing size in bytes of source file. `timestamp` and
`file_size` value can be 0 to indicate this information is not available.

`timestamp` value is in format of C and C++ data type `time_t`.

`file_size` is an unsigned 64-bit integer.

The `.file` directive is allowed only in the outermost scope, i.e., at the same level as kernel
and device function declarations.

Semantics

If timestamp and file size are not specified, they default to 0.

PTX ISA Notes

Introduced in PTX ISA version 1.0.

Timestamp and file size introduced in PTX ISA version 3.2.

Target ISA Notes

Supported on all target architectures.

Examples

```
.file 1 "example.cu"

.file 2 "kernel.cu"

.file 1 "kernel.cu", 1339013327, 64118
```

### 11.5.4. [Debugging Directives: `.loc`](#debugging-directives-loc)[](#debugging-directives-loc "Permalink to this headline")

`.loc`

Source file location.

Syntax

```
.loc file_index line_number column_position

.loc file_index line_number column_position,function_name label {+ immediate }, inlined_at file_index2 line_number2 column_position2
```

Description

Declares the source file location (source file, line number, and column position) to be associated
with lexically subsequent PTX instructions. `.loc` refers to `file_index` which is defined by a
`.file` directive.

To indicate PTX instructions that are generated from a function that got inlined, additional
attribute `.inlined_at` can be specified as part of the `.loc` directive. `.inlined_at`
attribute specifies source location at which the specified function is inlined. `file_index2`,
`line_number2`, and `column_position2` specify the location at which function is inlined. Source
location specified as part of `.inlined_at` directive must lexically precede as source location in
`.loc` directive.

The `function_name` attribute specifies an offset in the DWARF section named
`.debug_str`. Offset is specified as `label` expression or `label + immediate` expression
where `label` is defined in `.debug_str` section. DWARF section `.debug_str` contains ASCII
null-terminated strings that specify the name of the function that is inlined.

Note that a PTX instruction may have a single associated source location, determined by the nearest
lexically preceding .loc directive, or no associated source location if there is no preceding .loc
directive. Labels in PTX inherit the location of the closest lexically following instruction. A
label with no following PTX instruction has no associated source location.

PTX ISA Notes

Introduced in PTX ISA version 1.0.

`function_name` and `inlined_at` attributes are introduced in PTX ISA version 7.2.

Target ISA Notes

Supported on all target architectures.

Examples

```
    .loc 2 4237 0

L1:                        // line 4237, col 0 of file #2,

                           // inherited from mov

    mov.u32  %r1,%r2;      // line 4237, col 0 of file #2

    add.u32  %r2,%r1,%r3;  // line 4237, col 0 of file #2

...

L2:                        // line 4239, col 5 of file #2,

                           // inherited from sub

    .loc 2 4239 5

    sub.u32  %r2,%r1,%r3;  // line 4239, col 5 of file #2

    .loc 1 21 3

    .loc 1 9 3, function_name info_string0, inlined_at 1 21 3

    ld.global.u32   %r1, [gg]; // Function at line 9

    setp.lt.s32 %p1, %r1, 8;   // inlined at line 21

    .loc 1 27 3

    .loc 1 10 5, function_name info_string1, inlined_at 1 27 3

    .loc 1 15 3, function_name .debug_str+16, inlined_at 1 10 5

    setp.ne.s32 %p2, %r1, 18;

    @%p2 bra    BB2_3;



    .section .debug_str {

    info_string0:

     .b8 95  // _

     .b8 90  // z

     .b8 51  // 3

     .b8 102 // f

     .b8 111 // o

     .b8 111 // o

     .b8 118 // v

     .b8 0



    info_string1:

     .b8 95  // _

     .b8 90  // z

     .b8 51  // 3

     .b8 98  // b

     .b8 97  // a

     .b8 114 // r

     .b8 118 // v

     .b8 0

     .b8 95  // _

     .b8 90  // z

     .b8 51  // 3

     .b8 99  // c

     .b8 97  // a

     .b8 114 // r

     .b8 118 // v

     .b8 0

    }
```